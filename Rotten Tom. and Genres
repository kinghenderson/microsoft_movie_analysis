{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "2a15aaf0-a6ac-4a1e-b7df-806b4c1a7f96",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "d11972dd-6a17-450e-ac17-a983481ac58c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>release_date</th>\n",
       "      <th>movie</th>\n",
       "      <th>production_budget</th>\n",
       "      <th>domestic_gross</th>\n",
       "      <th>worldwide_gross</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>Dec 18, 2009</td>\n",
       "      <td>Avatar</td>\n",
       "      <td>$425,000,000</td>\n",
       "      <td>$760,507,625</td>\n",
       "      <td>$2,776,345,279</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>May 20, 2011</td>\n",
       "      <td>Pirates of the Caribbean: On Stranger Tides</td>\n",
       "      <td>$410,600,000</td>\n",
       "      <td>$241,063,875</td>\n",
       "      <td>$1,045,663,875</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Jun 7, 2019</td>\n",
       "      <td>Dark Phoenix</td>\n",
       "      <td>$350,000,000</td>\n",
       "      <td>$42,762,350</td>\n",
       "      <td>$149,762,350</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>May 1, 2015</td>\n",
       "      <td>Avengers: Age of Ultron</td>\n",
       "      <td>$330,600,000</td>\n",
       "      <td>$459,005,868</td>\n",
       "      <td>$1,403,013,963</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Dec 15, 2017</td>\n",
       "      <td>Star Wars Ep. VIII: The Last Jedi</td>\n",
       "      <td>$317,000,000</td>\n",
       "      <td>$620,181,382</td>\n",
       "      <td>$1,316,721,747</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5777</th>\n",
       "      <td>78</td>\n",
       "      <td>Dec 31, 2018</td>\n",
       "      <td>Red 11</td>\n",
       "      <td>$7,000</td>\n",
       "      <td>$0</td>\n",
       "      <td>$0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5778</th>\n",
       "      <td>79</td>\n",
       "      <td>Apr 2, 1999</td>\n",
       "      <td>Following</td>\n",
       "      <td>$6,000</td>\n",
       "      <td>$48,482</td>\n",
       "      <td>$240,495</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5779</th>\n",
       "      <td>80</td>\n",
       "      <td>Jul 13, 2005</td>\n",
       "      <td>Return to the Land of Wonders</td>\n",
       "      <td>$5,000</td>\n",
       "      <td>$1,338</td>\n",
       "      <td>$1,338</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5780</th>\n",
       "      <td>81</td>\n",
       "      <td>Sep 29, 2015</td>\n",
       "      <td>A Plague So Pleasant</td>\n",
       "      <td>$1,400</td>\n",
       "      <td>$0</td>\n",
       "      <td>$0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5781</th>\n",
       "      <td>82</td>\n",
       "      <td>Aug 5, 2005</td>\n",
       "      <td>My Date With Drew</td>\n",
       "      <td>$1,100</td>\n",
       "      <td>$181,041</td>\n",
       "      <td>$181,041</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5782 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      id  release_date                                        movie  \\\n",
       "0      1  Dec 18, 2009                                       Avatar   \n",
       "1      2  May 20, 2011  Pirates of the Caribbean: On Stranger Tides   \n",
       "2      3   Jun 7, 2019                                 Dark Phoenix   \n",
       "3      4   May 1, 2015                      Avengers: Age of Ultron   \n",
       "4      5  Dec 15, 2017            Star Wars Ep. VIII: The Last Jedi   \n",
       "...   ..           ...                                          ...   \n",
       "5777  78  Dec 31, 2018                                       Red 11   \n",
       "5778  79   Apr 2, 1999                                    Following   \n",
       "5779  80  Jul 13, 2005                Return to the Land of Wonders   \n",
       "5780  81  Sep 29, 2015                         A Plague So Pleasant   \n",
       "5781  82   Aug 5, 2005                            My Date With Drew   \n",
       "\n",
       "     production_budget domestic_gross worldwide_gross  \n",
       "0         $425,000,000   $760,507,625  $2,776,345,279  \n",
       "1         $410,600,000   $241,063,875  $1,045,663,875  \n",
       "2         $350,000,000    $42,762,350    $149,762,350  \n",
       "3         $330,600,000   $459,005,868  $1,403,013,963  \n",
       "4         $317,000,000   $620,181,382  $1,316,721,747  \n",
       "...                ...            ...             ...  \n",
       "5777            $7,000             $0              $0  \n",
       "5778            $6,000        $48,482        $240,495  \n",
       "5779            $5,000         $1,338          $1,338  \n",
       "5780            $1,400             $0              $0  \n",
       "5781            $1,100       $181,041        $181,041  \n",
       "\n",
       "[5782 rows x 6 columns]"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#importing data \n",
    "movie_budget = pd.read_csv('data/zippedData/tn.movie_budgets.csv.gz')\n",
    "movie_budget"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "e07765f4-fa98-4d5d-bb4b-b6f039e18123",
   "metadata": {},
   "outputs": [],
   "source": [
    "#importing data and dropping nan values \n",
    "rotten_tomatoes = pd.read_csv('data/zippeddata/rotten_tomatoes_movies.csv.gz')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "c68da4b5-b961-4827-9ca2-d08d92c1bce2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>rotten_tomatoes_link</th>\n",
       "      <th>movie_title</th>\n",
       "      <th>movie_info</th>\n",
       "      <th>critics_consensus</th>\n",
       "      <th>content_rating</th>\n",
       "      <th>genres</th>\n",
       "      <th>directors</th>\n",
       "      <th>authors</th>\n",
       "      <th>actors</th>\n",
       "      <th>original_release_date</th>\n",
       "      <th>...</th>\n",
       "      <th>production_company</th>\n",
       "      <th>tomatometer_status</th>\n",
       "      <th>tomatometer_rating</th>\n",
       "      <th>tomatometer_count</th>\n",
       "      <th>audience_status</th>\n",
       "      <th>audience_rating</th>\n",
       "      <th>audience_count</th>\n",
       "      <th>tomatometer_top_critics_count</th>\n",
       "      <th>tomatometer_fresh_critics_count</th>\n",
       "      <th>tomatometer_rotten_critics_count</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>16249</th>\n",
       "      <td>m/tie_me_up_tie_me_down</td>\n",
       "      <td>Átame! (Tie Me Up! Tie Me Down!)</td>\n",
       "      <td>Newly released from a mental institution, Rick...</td>\n",
       "      <td>Tie Me Up! Tie Me Down! undermines its own eff...</td>\n",
       "      <td>NC17</td>\n",
       "      <td>Art House &amp; International, Comedy, Drama, Romance</td>\n",
       "      <td>Pedro Almodóvar</td>\n",
       "      <td>Pedro Almodóvar</td>\n",
       "      <td>Victoria Abril, Antonio Banderas, Loles León, ...</td>\n",
       "      <td>1990-01-22</td>\n",
       "      <td>...</td>\n",
       "      <td>Miramax</td>\n",
       "      <td>Fresh</td>\n",
       "      <td>67.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Upright</td>\n",
       "      <td>79.0</td>\n",
       "      <td>17073.0</td>\n",
       "      <td>4</td>\n",
       "      <td>20</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17574</th>\n",
       "      <td>m/xxx_state_of_the_union</td>\n",
       "      <td>xXx: State of the Union</td>\n",
       "      <td>When the government finds out that a group of ...</td>\n",
       "      <td>Even more absurd and implausible than the firs...</td>\n",
       "      <td>R</td>\n",
       "      <td>Action &amp; Adventure</td>\n",
       "      <td>Lee Tamahori</td>\n",
       "      <td>Simon Kinberg, Lee Tamahori, Rich Wilkes</td>\n",
       "      <td>Ice Cube, Samuel L. Jackson, Willem Dafoe, Sco...</td>\n",
       "      <td>2005-04-29</td>\n",
       "      <td>...</td>\n",
       "      <td>Sony Pictures</td>\n",
       "      <td>Rotten</td>\n",
       "      <td>17.0</td>\n",
       "      <td>138.0</td>\n",
       "      <td>Spilled</td>\n",
       "      <td>32.0</td>\n",
       "      <td>113323.0</td>\n",
       "      <td>34</td>\n",
       "      <td>23</td>\n",
       "      <td>115</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10619</th>\n",
       "      <td>m/mother_2017</td>\n",
       "      <td>mother!</td>\n",
       "      <td>A young woman spends her days renovating the V...</td>\n",
       "      <td>There's no denying that mother! is the thought...</td>\n",
       "      <td>R</td>\n",
       "      <td>Drama, Horror, Mystery &amp; Suspense</td>\n",
       "      <td>Darren Aronofsky</td>\n",
       "      <td>Darren Aronofsky</td>\n",
       "      <td>Jennifer Lawrence, Javier Bardem, Ed Harris, M...</td>\n",
       "      <td>2017-09-15</td>\n",
       "      <td>...</td>\n",
       "      <td>Paramount Pictures</td>\n",
       "      <td>Fresh</td>\n",
       "      <td>68.0</td>\n",
       "      <td>374.0</td>\n",
       "      <td>Spilled</td>\n",
       "      <td>51.0</td>\n",
       "      <td>24931.0</td>\n",
       "      <td>51</td>\n",
       "      <td>256</td>\n",
       "      <td>118</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8157</th>\n",
       "      <td>m/iboy</td>\n",
       "      <td>iBoy</td>\n",
       "      <td>A teenager (Bill Milner) wakes from a coma to ...</td>\n",
       "      <td>iBoy's original premise and Maisie Williams' s...</td>\n",
       "      <td>NR</td>\n",
       "      <td>Action &amp; Adventure, Drama, Mystery &amp; Suspense,...</td>\n",
       "      <td>Adam Randall (II)</td>\n",
       "      <td>Joe Barton (VIII), Mark Denton, Jonny Stockwood</td>\n",
       "      <td>Bill Milner, Maisie Williams, Miranda Richards...</td>\n",
       "      <td>2017-01-27</td>\n",
       "      <td>...</td>\n",
       "      <td>Netflix</td>\n",
       "      <td>Fresh</td>\n",
       "      <td>69.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>Spilled</td>\n",
       "      <td>39.0</td>\n",
       "      <td>786.0</td>\n",
       "      <td>3</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12333</th>\n",
       "      <td>m/rec_2</td>\n",
       "      <td>[Rec] 2</td>\n",
       "      <td>A doctor and a SWAT team enter a quarantined b...</td>\n",
       "      <td>It lacks the surprising jolt of the first inst...</td>\n",
       "      <td>R</td>\n",
       "      <td>Drama, Horror, Mystery &amp; Suspense, Special Int...</td>\n",
       "      <td>Paca Plaza, Jaume Balagueró, Paco Plaza</td>\n",
       "      <td>Manu Diez</td>\n",
       "      <td>Jonathan Mellor, Oscar Sanchez Zafra, Ariel Ca...</td>\n",
       "      <td>2010-07-09</td>\n",
       "      <td>...</td>\n",
       "      <td>Magnolia Pictures</td>\n",
       "      <td>Fresh</td>\n",
       "      <td>68.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>Upright</td>\n",
       "      <td>60.0</td>\n",
       "      <td>15340.0</td>\n",
       "      <td>18</td>\n",
       "      <td>49</td>\n",
       "      <td>23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>191</th>\n",
       "      <td>m/1000_times_good_night</td>\n",
       "      <td>1,000 Times Good Night</td>\n",
       "      <td>A war-zone photojournalist's (Juliette Binoche...</td>\n",
       "      <td>Beautifully filmed and powerfully acted, 1,000...</td>\n",
       "      <td>NR</td>\n",
       "      <td>Drama</td>\n",
       "      <td>Erik Poppe</td>\n",
       "      <td>Harald Rosenløw-Eeg</td>\n",
       "      <td>Juliette Binoche, Nikolaj Coster-Waldau, Laury...</td>\n",
       "      <td>2014-10-24</td>\n",
       "      <td>...</td>\n",
       "      <td>Film Movement</td>\n",
       "      <td>Fresh</td>\n",
       "      <td>71.0</td>\n",
       "      <td>55.0</td>\n",
       "      <td>Upright</td>\n",
       "      <td>65.0</td>\n",
       "      <td>1884.0</td>\n",
       "      <td>22</td>\n",
       "      <td>39</td>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2743</th>\n",
       "      <td>m/and_justice_for_all</td>\n",
       "      <td>...And Justice for All</td>\n",
       "      <td>Satirical drama in which an idealistic lawyer ...</td>\n",
       "      <td>A volcanic Al Pacino holds court in this histr...</td>\n",
       "      <td>R</td>\n",
       "      <td>Comedy, Drama, Mystery &amp; Suspense</td>\n",
       "      <td>Norman Jewison</td>\n",
       "      <td>Barry Levinson, Valerie Curtin</td>\n",
       "      <td>Al Pacino, Jack Warden, John Forsythe, Lee Str...</td>\n",
       "      <td>1979-06-29</td>\n",
       "      <td>...</td>\n",
       "      <td>Columbia Pictures</td>\n",
       "      <td>Fresh</td>\n",
       "      <td>83.0</td>\n",
       "      <td>29.0</td>\n",
       "      <td>Upright</td>\n",
       "      <td>80.0</td>\n",
       "      <td>19067.0</td>\n",
       "      <td>7</td>\n",
       "      <td>24</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17562</th>\n",
       "      <td>m/x_the_man_with_the_x_ray_eyes</td>\n",
       "      <td>'X'---The Man With the X-Ray Eyes</td>\n",
       "      <td>Intent on enhancing mankind's ocular ability, ...</td>\n",
       "      <td>By turns lurid and disturbing, The Man with th...</td>\n",
       "      <td>R</td>\n",
       "      <td>Cult Movies, Horror, Science Fiction &amp; Fantasy</td>\n",
       "      <td>Roger Corman</td>\n",
       "      <td>Ray Russell, Robert Dillon</td>\n",
       "      <td>Ray Milland, Don Rickles, Harold J. Stone, Dia...</td>\n",
       "      <td>1963-09-18</td>\n",
       "      <td>...</td>\n",
       "      <td>Orion Home Video</td>\n",
       "      <td>Fresh</td>\n",
       "      <td>88.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>Upright</td>\n",
       "      <td>66.0</td>\n",
       "      <td>3224.0</td>\n",
       "      <td>5</td>\n",
       "      <td>22</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2033</th>\n",
       "      <td>m/71_2015</td>\n",
       "      <td>'71</td>\n",
       "      <td>A young British soldier (Jack O'Connell) must ...</td>\n",
       "      <td>Powerfully directed and acted, '71 stays true ...</td>\n",
       "      <td>PG-13</td>\n",
       "      <td>Action &amp; Adventure, Drama</td>\n",
       "      <td>Yann Demange</td>\n",
       "      <td>Gregory Burke</td>\n",
       "      <td>Jack O'Connell, Sean Harris, Jack Lowden, Char...</td>\n",
       "      <td>2015-02-27</td>\n",
       "      <td>...</td>\n",
       "      <td>Roadside Attractions</td>\n",
       "      <td>Certified-Fresh</td>\n",
       "      <td>96.0</td>\n",
       "      <td>138.0</td>\n",
       "      <td>Upright</td>\n",
       "      <td>81.0</td>\n",
       "      <td>17420.0</td>\n",
       "      <td>42</td>\n",
       "      <td>132</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2055</th>\n",
       "      <td>m/999_2008</td>\n",
       "      <td>$9.99</td>\n",
       "      <td>Residents of a Sydney, Australia, apartment co...</td>\n",
       "      <td>Its storyline isn't as wondrous as its visuals...</td>\n",
       "      <td>R</td>\n",
       "      <td>Animation, Art House &amp; International, Comedy</td>\n",
       "      <td>Tatia Rosenthal</td>\n",
       "      <td>Etgar Keret, Tatia Rosenthal</td>\n",
       "      <td>Geoffrey Rush, Anthony LaPaglia, Samuel Johnso...</td>\n",
       "      <td>2008-09-04</td>\n",
       "      <td>...</td>\n",
       "      <td>Regent Releasing</td>\n",
       "      <td>Certified-Fresh</td>\n",
       "      <td>73.0</td>\n",
       "      <td>55.0</td>\n",
       "      <td>Spilled</td>\n",
       "      <td>55.0</td>\n",
       "      <td>5339.0</td>\n",
       "      <td>24</td>\n",
       "      <td>40</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8077 rows × 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                  rotten_tomatoes_link                        movie_title  \\\n",
       "16249          m/tie_me_up_tie_me_down   Átame! (Tie Me Up! Tie Me Down!)   \n",
       "17574         m/xxx_state_of_the_union            xXx: State of the Union   \n",
       "10619                    m/mother_2017                            mother!   \n",
       "8157                            m/iboy                               iBoy   \n",
       "12333                          m/rec_2                            [Rec] 2   \n",
       "...                                ...                                ...   \n",
       "191            m/1000_times_good_night             1,000 Times Good Night   \n",
       "2743             m/and_justice_for_all             ...And Justice for All   \n",
       "17562  m/x_the_man_with_the_x_ray_eyes  'X'---The Man With the X-Ray Eyes   \n",
       "2033                         m/71_2015                                '71   \n",
       "2055                        m/999_2008                              $9.99   \n",
       "\n",
       "                                              movie_info  \\\n",
       "16249  Newly released from a mental institution, Rick...   \n",
       "17574  When the government finds out that a group of ...   \n",
       "10619  A young woman spends her days renovating the V...   \n",
       "8157   A teenager (Bill Milner) wakes from a coma to ...   \n",
       "12333  A doctor and a SWAT team enter a quarantined b...   \n",
       "...                                                  ...   \n",
       "191    A war-zone photojournalist's (Juliette Binoche...   \n",
       "2743   Satirical drama in which an idealistic lawyer ...   \n",
       "17562  Intent on enhancing mankind's ocular ability, ...   \n",
       "2033   A young British soldier (Jack O'Connell) must ...   \n",
       "2055   Residents of a Sydney, Australia, apartment co...   \n",
       "\n",
       "                                       critics_consensus content_rating  \\\n",
       "16249  Tie Me Up! Tie Me Down! undermines its own eff...           NC17   \n",
       "17574  Even more absurd and implausible than the firs...              R   \n",
       "10619  There's no denying that mother! is the thought...              R   \n",
       "8157   iBoy's original premise and Maisie Williams' s...             NR   \n",
       "12333  It lacks the surprising jolt of the first inst...              R   \n",
       "...                                                  ...            ...   \n",
       "191    Beautifully filmed and powerfully acted, 1,000...             NR   \n",
       "2743   A volcanic Al Pacino holds court in this histr...              R   \n",
       "17562  By turns lurid and disturbing, The Man with th...              R   \n",
       "2033   Powerfully directed and acted, '71 stays true ...          PG-13   \n",
       "2055   Its storyline isn't as wondrous as its visuals...              R   \n",
       "\n",
       "                                                  genres  \\\n",
       "16249  Art House & International, Comedy, Drama, Romance   \n",
       "17574                                 Action & Adventure   \n",
       "10619                  Drama, Horror, Mystery & Suspense   \n",
       "8157   Action & Adventure, Drama, Mystery & Suspense,...   \n",
       "12333  Drama, Horror, Mystery & Suspense, Special Int...   \n",
       "...                                                  ...   \n",
       "191                                                Drama   \n",
       "2743                   Comedy, Drama, Mystery & Suspense   \n",
       "17562     Cult Movies, Horror, Science Fiction & Fantasy   \n",
       "2033                           Action & Adventure, Drama   \n",
       "2055        Animation, Art House & International, Comedy   \n",
       "\n",
       "                                     directors  \\\n",
       "16249                          Pedro Almodóvar   \n",
       "17574                             Lee Tamahori   \n",
       "10619                         Darren Aronofsky   \n",
       "8157                         Adam Randall (II)   \n",
       "12333  Paca Plaza, Jaume Balagueró, Paco Plaza   \n",
       "...                                        ...   \n",
       "191                                 Erik Poppe   \n",
       "2743                            Norman Jewison   \n",
       "17562                             Roger Corman   \n",
       "2033                              Yann Demange   \n",
       "2055                           Tatia Rosenthal   \n",
       "\n",
       "                                               authors  \\\n",
       "16249                                  Pedro Almodóvar   \n",
       "17574         Simon Kinberg, Lee Tamahori, Rich Wilkes   \n",
       "10619                                 Darren Aronofsky   \n",
       "8157   Joe Barton (VIII), Mark Denton, Jonny Stockwood   \n",
       "12333                                        Manu Diez   \n",
       "...                                                ...   \n",
       "191                                Harald Rosenløw-Eeg   \n",
       "2743                    Barry Levinson, Valerie Curtin   \n",
       "17562                       Ray Russell, Robert Dillon   \n",
       "2033                                     Gregory Burke   \n",
       "2055                      Etgar Keret, Tatia Rosenthal   \n",
       "\n",
       "                                                  actors  \\\n",
       "16249  Victoria Abril, Antonio Banderas, Loles León, ...   \n",
       "17574  Ice Cube, Samuel L. Jackson, Willem Dafoe, Sco...   \n",
       "10619  Jennifer Lawrence, Javier Bardem, Ed Harris, M...   \n",
       "8157   Bill Milner, Maisie Williams, Miranda Richards...   \n",
       "12333  Jonathan Mellor, Oscar Sanchez Zafra, Ariel Ca...   \n",
       "...                                                  ...   \n",
       "191    Juliette Binoche, Nikolaj Coster-Waldau, Laury...   \n",
       "2743   Al Pacino, Jack Warden, John Forsythe, Lee Str...   \n",
       "17562  Ray Milland, Don Rickles, Harold J. Stone, Dia...   \n",
       "2033   Jack O'Connell, Sean Harris, Jack Lowden, Char...   \n",
       "2055   Geoffrey Rush, Anthony LaPaglia, Samuel Johnso...   \n",
       "\n",
       "      original_release_date  ...    production_company  tomatometer_status  \\\n",
       "16249            1990-01-22  ...               Miramax               Fresh   \n",
       "17574            2005-04-29  ...         Sony Pictures              Rotten   \n",
       "10619            2017-09-15  ...    Paramount Pictures               Fresh   \n",
       "8157             2017-01-27  ...               Netflix               Fresh   \n",
       "12333            2010-07-09  ...     Magnolia Pictures               Fresh   \n",
       "...                     ...  ...                   ...                 ...   \n",
       "191              2014-10-24  ...         Film Movement               Fresh   \n",
       "2743             1979-06-29  ...     Columbia Pictures               Fresh   \n",
       "17562            1963-09-18  ...      Orion Home Video               Fresh   \n",
       "2033             2015-02-27  ...  Roadside Attractions     Certified-Fresh   \n",
       "2055             2008-09-04  ...      Regent Releasing     Certified-Fresh   \n",
       "\n",
       "      tomatometer_rating tomatometer_count  audience_status  audience_rating  \\\n",
       "16249               67.0              30.0          Upright             79.0   \n",
       "17574               17.0             138.0          Spilled             32.0   \n",
       "10619               68.0             374.0          Spilled             51.0   \n",
       "8157                69.0              13.0          Spilled             39.0   \n",
       "12333               68.0              72.0          Upright             60.0   \n",
       "...                  ...               ...              ...              ...   \n",
       "191                 71.0              55.0          Upright             65.0   \n",
       "2743                83.0              29.0          Upright             80.0   \n",
       "17562               88.0              25.0          Upright             66.0   \n",
       "2033                96.0             138.0          Upright             81.0   \n",
       "2055                73.0              55.0          Spilled             55.0   \n",
       "\n",
       "      audience_count  tomatometer_top_critics_count  \\\n",
       "16249        17073.0                              4   \n",
       "17574       113323.0                             34   \n",
       "10619        24931.0                             51   \n",
       "8157           786.0                              3   \n",
       "12333        15340.0                             18   \n",
       "...              ...                            ...   \n",
       "191           1884.0                             22   \n",
       "2743         19067.0                              7   \n",
       "17562         3224.0                              5   \n",
       "2033         17420.0                             42   \n",
       "2055          5339.0                             24   \n",
       "\n",
       "       tomatometer_fresh_critics_count  tomatometer_rotten_critics_count  \n",
       "16249                               20                                10  \n",
       "17574                               23                               115  \n",
       "10619                              256                               118  \n",
       "8157                                 9                                 4  \n",
       "12333                               49                                23  \n",
       "...                                ...                               ...  \n",
       "191                                 39                                16  \n",
       "2743                                24                                 5  \n",
       "17562                               22                                 3  \n",
       "2033                               132                                 6  \n",
       "2055                                40                                15  \n",
       "\n",
       "[8077 rows x 22 columns]"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sorted_movies = rotten_tomatoes.sort_values(by='movie_title', ascending=False).dropna()\n",
    "sorted_movies"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "6cb730cf-6d10-406c-81bb-3e94e4fb4c99",
   "metadata": {},
   "outputs": [],
   "source": [
    "#merged_df2 = movie_budget.merge(right= tomatometer_rating, how = 'inner', left_on = 'movie', right_on = 'movie_title', suffixes=('_','_')).head(50)\n",
    "#merged_df2 = pd.concat([sorted_movies, movie_budget], axis=1, join='inner')\n",
    "#merged_df2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "id": "8bf08ee4-6dda-4560-a245-9095174b8fe5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#creating a new data set from the data set above \n",
    "data = [sorted_movies[\"movie_title\"], sorted_movies[\"genres\"], sorted_movies[\"tomatometer_rating\"], sorted_movies['audience_rating']]\n",
    "headers = [\"movie_title\", \"genres\", \"tomatometer_rating\", \"audience_rating\"]\n",
    "moviesandratings_df = pd.concat(data, axis=1, keys=headers)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 74,
   "id": "3b912d9d-63d4-4eb1-b973-cb83f64d9930",
   "metadata": {},
   "outputs": [],
   "source": [
    "#taking out zero values/nan values and making the table ascending false(highest value to lowest)\n",
    "moviesandratings_df.replace(0, np.nan, inplace=True)\n",
    "moviesandratings_df = moviesandratings_df.sort_values(by='tomatometer_rating', ascending=False).dropna()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 76,
   "id": "1f6ea291-7a7b-4fa1-b15b-c02b51da4c38",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>movie_title</th>\n",
       "      <th>genres</th>\n",
       "      <th>tomatometer_rating</th>\n",
       "      <th>audience_rating</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>14378</th>\n",
       "      <td>That Obscure Object of Desire</td>\n",
       "      <td>Comedy, Drama</td>\n",
       "      <td>100.0</td>\n",
       "      <td>90.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7802</th>\n",
       "      <td>Holiday Inn</td>\n",
       "      <td>Classics, Comedy, Musical &amp; Performing Arts, R...</td>\n",
       "      <td>100.0</td>\n",
       "      <td>86.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9304</th>\n",
       "      <td>Law of Desire</td>\n",
       "      <td>Art House &amp; International, Comedy, Drama, Myst...</td>\n",
       "      <td>100.0</td>\n",
       "      <td>82.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10156</th>\n",
       "      <td>Mary Poppins</td>\n",
       "      <td>Classics, Comedy, Kids &amp; Family, Musical &amp; Per...</td>\n",
       "      <td>100.0</td>\n",
       "      <td>86.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>581</th>\n",
       "      <td>M</td>\n",
       "      <td>Art House &amp; International, Drama, Mystery &amp; Su...</td>\n",
       "      <td>100.0</td>\n",
       "      <td>95.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3153</th>\n",
       "      <td>Au Hasard Balthazar</td>\n",
       "      <td>Art House &amp; International, Drama</td>\n",
       "      <td>100.0</td>\n",
       "      <td>86.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11918</th>\n",
       "      <td>Poetry</td>\n",
       "      <td>Art House &amp; International, Drama</td>\n",
       "      <td>100.0</td>\n",
       "      <td>86.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12330</th>\n",
       "      <td>Rebels of the Neon God</td>\n",
       "      <td>Art House &amp; International, Drama</td>\n",
       "      <td>100.0</td>\n",
       "      <td>76.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4057</th>\n",
       "      <td>Broadway Danny Rose</td>\n",
       "      <td>Comedy, Romance</td>\n",
       "      <td>100.0</td>\n",
       "      <td>84.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5213</th>\n",
       "      <td>Day for Night</td>\n",
       "      <td>Art House &amp; International, Comedy, Drama, Romance</td>\n",
       "      <td>100.0</td>\n",
       "      <td>91.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13255</th>\n",
       "      <td>The Shop Around the Corner</td>\n",
       "      <td>Classics, Comedy, Drama, Romance</td>\n",
       "      <td>100.0</td>\n",
       "      <td>91.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>557</th>\n",
       "      <td>Laura</td>\n",
       "      <td>Classics, Mystery &amp; Suspense</td>\n",
       "      <td>100.0</td>\n",
       "      <td>90.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12174</th>\n",
       "      <td>Quai des Orfèvres (Quay of the Goldsmiths) (Je...</td>\n",
       "      <td>Art House &amp; International, Classics, Drama</td>\n",
       "      <td>100.0</td>\n",
       "      <td>89.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11001</th>\n",
       "      <td>A New Leaf</td>\n",
       "      <td>Classics, Comedy, Romance</td>\n",
       "      <td>100.0</td>\n",
       "      <td>83.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16332</th>\n",
       "      <td>Tokyo Story (Tôkyô monogatari)</td>\n",
       "      <td>Art House &amp; International, Drama</td>\n",
       "      <td>100.0</td>\n",
       "      <td>93.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11401</th>\n",
       "      <td>Open City</td>\n",
       "      <td>Art House &amp; International, Drama</td>\n",
       "      <td>100.0</td>\n",
       "      <td>92.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2161</th>\n",
       "      <td>A Man Escaped (Un condamné à mort s'est échapp...</td>\n",
       "      <td>Action &amp; Adventure, Art House &amp; International,...</td>\n",
       "      <td>100.0</td>\n",
       "      <td>93.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10670</th>\n",
       "      <td>Mr. Hulot's Holiday (Les Vacances de Monsieur ...</td>\n",
       "      <td>Comedy</td>\n",
       "      <td>100.0</td>\n",
       "      <td>85.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>588</th>\n",
       "      <td>The Maltese Falcon</td>\n",
       "      <td>Drama, Mystery &amp; Suspense</td>\n",
       "      <td>100.0</td>\n",
       "      <td>91.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9634</th>\n",
       "      <td>Local Hero</td>\n",
       "      <td>Art House &amp; International, Comedy, Drama</td>\n",
       "      <td>100.0</td>\n",
       "      <td>87.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                             movie_title  \\\n",
       "14378                      That Obscure Object of Desire   \n",
       "7802                                         Holiday Inn   \n",
       "9304                                       Law of Desire   \n",
       "10156                                       Mary Poppins   \n",
       "581                                                    M   \n",
       "3153                                 Au Hasard Balthazar   \n",
       "11918                                             Poetry   \n",
       "12330                             Rebels of the Neon God   \n",
       "4057                                 Broadway Danny Rose   \n",
       "5213                                       Day for Night   \n",
       "13255                         The Shop Around the Corner   \n",
       "557                                                Laura   \n",
       "12174  Quai des Orfèvres (Quay of the Goldsmiths) (Je...   \n",
       "11001                                         A New Leaf   \n",
       "16332                     Tokyo Story (Tôkyô monogatari)   \n",
       "11401                                          Open City   \n",
       "2161   A Man Escaped (Un condamné à mort s'est échapp...   \n",
       "10670  Mr. Hulot's Holiday (Les Vacances de Monsieur ...   \n",
       "588                                   The Maltese Falcon   \n",
       "9634                                          Local Hero   \n",
       "\n",
       "                                                  genres  tomatometer_rating  \\\n",
       "14378                                      Comedy, Drama               100.0   \n",
       "7802   Classics, Comedy, Musical & Performing Arts, R...               100.0   \n",
       "9304   Art House & International, Comedy, Drama, Myst...               100.0   \n",
       "10156  Classics, Comedy, Kids & Family, Musical & Per...               100.0   \n",
       "581    Art House & International, Drama, Mystery & Su...               100.0   \n",
       "3153                    Art House & International, Drama               100.0   \n",
       "11918                   Art House & International, Drama               100.0   \n",
       "12330                   Art House & International, Drama               100.0   \n",
       "4057                                     Comedy, Romance               100.0   \n",
       "5213   Art House & International, Comedy, Drama, Romance               100.0   \n",
       "13255                   Classics, Comedy, Drama, Romance               100.0   \n",
       "557                         Classics, Mystery & Suspense               100.0   \n",
       "12174         Art House & International, Classics, Drama               100.0   \n",
       "11001                          Classics, Comedy, Romance               100.0   \n",
       "16332                   Art House & International, Drama               100.0   \n",
       "11401                   Art House & International, Drama               100.0   \n",
       "2161   Action & Adventure, Art House & International,...               100.0   \n",
       "10670                                             Comedy               100.0   \n",
       "588                            Drama, Mystery & Suspense               100.0   \n",
       "9634            Art House & International, Comedy, Drama               100.0   \n",
       "\n",
       "       audience_rating  \n",
       "14378             90.0  \n",
       "7802              86.0  \n",
       "9304              82.0  \n",
       "10156             86.0  \n",
       "581               95.0  \n",
       "3153              86.0  \n",
       "11918             86.0  \n",
       "12330             76.0  \n",
       "4057              84.0  \n",
       "5213              91.0  \n",
       "13255             91.0  \n",
       "557               90.0  \n",
       "12174             89.0  \n",
       "11001             83.0  \n",
       "16332             93.0  \n",
       "11401             92.0  \n",
       "2161              93.0  \n",
       "10670             85.0  \n",
       "588               91.0  \n",
       "9634              87.0  "
      ]
     },
     "execution_count": 76,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "moviesandratings_df.head(20)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 78,
   "id": "1e163c71-2862-4510-bb9e-710d4cabd1fe",
   "metadata": {},
   "outputs": [
    {
     "ename": "SyntaxError",
     "evalue": "unexpected EOF while parsing (<ipython-input-78-31d02c3df480>, line 4)",
     "output_type": "error",
     "traceback": [
      "\u001b[1;36m  File \u001b[1;32m\"<ipython-input-78-31d02c3df480>\"\u001b[1;36m, line \u001b[1;32m4\u001b[0m\n\u001b[1;33m    moviesandratings_df['audience_rating'].plot(secondary_y=True, style='g', rot=90, figsize=(12,6)\u001b[0m\n\u001b[1;37m                                                                                                   ^\u001b[0m\n\u001b[1;31mSyntaxError\u001b[0m\u001b[1;31m:\u001b[0m unexpected EOF while parsing\n"
     ]
    }
   ],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b91dd9d2-7851-4a14-bbf1-25b9b9c4baed",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "learn-env",
   "language": "python",
   "name": "learn-env"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
